Objective:Implement a robust sound source localization and counting system in ./localization/ based on the Zhang & Rao (2010) paper: "A Two Microphone-Based Approach for Source Localization of Multiple Speech Sources." The system must handle $M$ microphones by clustering Inter-channel Phase Difference (IPD) vectors.1. Data Selection (High-SNR Points)Use Short-Time DFT (25-ms window, 10-ms shift).Implement Power Thresholding: Sort time-frequency (TF) points by power and select the top 10%. This is a computationally efficient approximation to the sinusoidal modeling described in the paper.2. IPD Vector Representation (Multichannel Extension)Select Microphone 1 as the reference.For each selected TF point $(t, \omega)$, construct the observation vector $\mathbf{y}_i$:$$\mathbf{y}_i = [\psi_{1,2}(\omega), \psi_{1,3}(\omega), \dots, \psi_{1,M}(\omega)]^T$$where $\psi_{1,m}(\omega) = \angle X_1(\omega) - \angle X_m(\omega)$.3. GMDA_Laplace Algorithm (The EM Loop)
Implement the Generalized Mixture Decomposition Algorithm (GMDA) with a Laplacian distribution, as it is more robust to outliers than Gaussian models.E-Step: Compute the posterior probability $P(C_j|y_i)$ that point $i$ belongs to source $j$ using the Laplacian PDF:
$$p(y_i|C_j) = \prod_{k=2}^M \frac{1}{2b_j} \exp\left(-\frac{|\psi_{1,k}(\omega_i) - \alpha_{j,k} \cdot \omega_i|}{b_j}\right)$$M-Step: Update the line slopes $\alpha_{j,k}$ (representing time delays) using Newton-type numerical optimization to maximize the weighted log-likelihood. Update the variance parameter $b_j$.4. Model Selection (Source Counting)Implement the Minimum Description Length (MDL) criterion to estimate the number of active sources $m$.Use the modified penalty term $\overline{\beta} k_p(m) \ln N$, where $\overline{\beta} > 0.5$, to prevent overestimation in your 5x5m simulated environment.5. Initialization & IntegrationInitialization: Use the ITD Histogram method. Convert IPDs to ITDs ($\tau = \psi/\omega$), bin them, and pick local peaks to seed the GMDA slopes.Simulation: Utilize @beamforming/util/simulate.py to test the system with 3-second speech samples from TIMIT, mimicking the paperâ€™s experimental setup.Spatial Aliasing: If the mic spacing $d$ is large (e.g., your 12cm setup), implement the phase unwrapping logic $\psi' = \psi + 2\pi n$ within the likelihood maximization.Key Parameters for ImplementationParameterValue from PaperRationaleDFT Length256 points Standard for 8kHz; adjust for your 16kHz fs.Power ThresholdTop 10% Best balance for low SNR/Echoic environments.Noise ModelLaplacian Superior robustness to reverberation.MDL Penalty ($\overline{\beta}$)$> 0.5$ Necessary to avoid "ghost" speaker detections.Next Step for Agent: Please generate the GMDALaplace class in localization/algo.py and implement the _newton_update method for the M-step. Use your existing MicType.CIRCULAR geometry to define the steering vector constraints.


ALL of the above must be implemented suh that it is interoperable with the rest of the methods in the lcoalization directory. this should be easy to choose the method type when usig this module as a service called from other scripts
